# ------------------  INPUTS TO MAIN PROGRAM  -------------------
stop_time = 10000 #540 min = 9 h (Cuxart et al. 2006)

amrex.fpe_trap_invalid = 0

fabarray.mfiter_tile_size = 1024 1024 1024

# PROBLEM SIZE & GEOMETRY (Cuxart et al. 2006)
geometry.prob_extent = 8000  8000  2048
amr.n_cell           =  8   8   64


geometry.is_periodic = 1 1 0
erf.initial_dz = 4.0
erf.grid_stretching_ratio = 1.06

# MOST BOUNDARY (DEFAULT IS ADIABATIC FOR THETA)
zlo.type = "surface_layer"
erf.most.z0                 = 0.1  # from Cuxart et al. 2006
erf.most.surf_temp_flux    = 0.24
erf.most.zref = 10 

zhi.type        = "SlipWall"
zhi.theta_grad  = 0.003  # [K/m] to match the input sounding

# INITIALIZATION (Cuxart et al. 2006)
erf.init_type           = "input_sounding"
erf.sounding_type = Ideal
erf.input_sounding_file = "mrf_sounding_unstable"

# TIME STEP CONTROL
erf.cfl = 0.25
erf.substepping_cfl = 0.5

# DIAGNOSTICS & VERBOSITY
erf.sum_interval    = 1       # timesteps between computing mass
erf.v               = 1       # verbosity in ERF.cpp
amr.v               = 1       # verbosity in Amr.cpp

# REFINEMENT / REGRIDDING
amr.max_level       = 0       # maximum level number allowed

# CHECKPOINT FILES
erf.check_file      = chk        # root name of checkpoint file
erf.check_int       = -1         # number of timesteps between checkpoints

# PLOTFILES
erf.plot_file_1     = plt       # prefix of plotfile name
erf.plot_int_1      = 25000        # number of timesteps between plotfiles
erf.plot_vars_1     = density x_velocity y_velocity z_velocity pressure theta rhoKE Kmv Khv Lpbl


# DATA COLLECTION
erf.data_log        = surf_hist.dat mean_profiles.dat flux_profiles.dat sfs_profiles.dat
erf.profile_int     = 1000 # steps
erf.destag_profiles = false # output quantities related to w at staggered vertical levels (optional)

# SOLVER CHOICE
erf.dycore_vert_adv_type   = "Upwind_5th"
erf.dryscal_vert_adv_type  = "Upwind_3rd"

erf.molec_diff_type = "None"

erf.use_gravity = true

# Coriolis parameter f = 1.39e-4 s^-1 (Cuxart et al. 2006)
erf.use_coriolis = true
erf.latitude = 45.0
erf.rotational_time_period = 86455.2516813368

# Geostrophic wind (Cuxart et al. 2006)
erf.abl_driver_type = "GeostrophicWind"
erf.abl_geo_wind = 15.0 0.0 0.0

# Turbulence closure
erf.les_type    = "None"
erf.pbl_type    = "MRF"
erf.pbl_mrf_coriolis_freq = 1e-4
erf.pbl_mrf_Ribcr = 0.5 

# Rayleigh 
erf.rayleigh_damp_U = true 
erf.rayleigh_damp_V = true 
erf.rayleigh_damp_T = true 
erf.rayleigh_damp_W = true 
erf.rayleigh_zdamp = 512 
erf.rayleigh_dampcoef = 0.05
