# ------------------  INPUTS TO MAIN PROGRAM  -------------------
erf.anelastic = 1
erf.use_fft = 1

stop_time = 9000.0

amrex.fpe_trap_invalid = 1

fabarray.mfiter_tile_size = 1024 1024 1024

# PROBLEM SIZE & GEOMETRY
geometry.prob_extent =  5000    5000    2000
amr.n_cell           =    96      96      96
amr.n_cell           =   128     128     128

geometry.is_periodic = 1 1 0

# MOST BOUNDARY (DEFAULT IS ADIABATIC FOR THETA)
zlo.type      = surface_layer
erf.most.z0   = 0.16  # see Abkar & Moin 2017
#erf.most.surf_temp_flux = 0.24
#erf.most.surf_heating_rate = 1.0

zhi.type        = SlipWall
zhi.theta_grad  = 0.003

# INITIALIZATION
erf.init_type           = input_sounding
erf.input_sounding_file = "input_sounding_MS94_B"

# TIME STEP CONTROL
#erf.fixed_dt        = 0.25
#erf.substepping_cfl = 0.5
erf.cfl = 0.5

# DIAGNOSTICS & VERBOSITY
erf.sum_interval   = 1       # timesteps between computing mass
erf.v              = 1       # verbosity in ERF.cpp
amr.v              = 1       # verbosity in Amr.cpp

# planar averaging
#erf.data_log    = surf_hist.dat mean_profiles.dat flux_profiles.dat sfs_profiles.dat
#erf.profile_int = 5
#erf.destag_profiles = false

# REFINEMENT / REGRIDDING
amr.max_level       = 0       # maximum level number allowed

# CHECKPOINT FILES
erf.check_file      = chk        # root name of checkpoint file
erf.check_int       = 2400       # number of timesteps between checkpoints

# PLOTFILES
erf.plot_file_1     = plt       # prefix of plotfile name
erf.plot_int_1      = 2400      # number of timesteps between plotfiles
erf.plot_vars_1     = density x_velocity y_velocity z_velocity pressure theta KE

# SOLVER CHOICE
erf.dycore_horiz_adv_type   = "Upwind_5th"
erf.dycore_vert_adv_type    = "Upwind_3rd"
erf.dryscal_horiz_adv_type  = "Upwind_5th"
erf.dryscal_vert_adv_type   = "Upwind_3rd"

erf.use_gravity = true
erf.use_coriolis = true
erf.coriolis_3d = false
erf.rotational_time_period = 125663.7061435917  # f = 1e-4

erf.abl_driver_type = "GeostrophicWind"
erf.abl_geo_wind    = 10. 0. 0.

erf.molec_diff_type = "None"
erf.les_type        = "Deardorff"
erf.Ck              = 0.1  # Coefficient in Moeng1984, Eqn. 19
erf.Ce              = 0.7  # Note: Ce_lcoeff = C_e - 1.9*C_k)
erf.Ce_wall         = 3.9  # To account for "wall effects"
erf.sigma_k         = 0.5  # TKE diffusion coeff = 2*Km = Km * inv_sigma_k, Moeng1984, Eqn. 15
erf.theta_ref       = 300.0

# PROBLEM PARAMETERS
prob.pert_deltaU        = 1.0
prob.pert_deltaV        = 1.0
prob.pert_periods_U     = 5.0 # default
prob.pert_periods_V     = 5.0 # default
prob.pert_ref_height    = 100.0 # default
