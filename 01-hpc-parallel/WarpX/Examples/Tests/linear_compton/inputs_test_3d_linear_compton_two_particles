#################################
####### GENERAL PARAMETERS ######
#################################
max_step = 100
amr.n_cell = 16 16 16
amr.max_grid_size = 16
amr.blocking_factor = 4
amr.max_level = 0
geometry.dims = 3
geometry.prob_lo = -1e-6 -1e-6 -1e-6
geometry.prob_hi = 1e-6 1e-6 1e-6

#################################
##### BOUNDARY CONDITIONS #######
#################################
boundary.field_lo = periodic periodic periodic
boundary.field_hi = periodic periodic periodic

#################################
############ NUMERICS ###########
#################################
warpx.verbose = 1
warpx.cfl = 1.0
algo.particle_shape = 1

#################################
############ PLASMA #############
#################################
particles.species_names = photon1 electron1 photon2 electron2
particles.photon_species = photon1 photon2

photon1.species_type = photon
photon1.injection_style = "SingleParticle"
photon1.single_particle_pos = 0 0 0
photon1.single_particle_u = 2.8 0 0
photon1.single_particle_weight = 1e14
photon1.do_not_push = 1

electron1.species_type = electron
electron1.injection_style = "SingleParticle"
electron1.single_particle_pos = 0 0 0
electron1.single_particle_u = -2.8 0 0
electron1.single_particle_weight = 1e14
electron1.do_not_push = 1

electron2.species_type = electron
electron2.injection_style = none
electron2.do_not_push = 1

photon2.species_type = photon
photon2.injection_style = none
photon2.do_not_push = 1

#################################
############ COLLISION ##########
#################################
collisions.collision_names = lc # linear Compton
lc.species = photon1 electron1
lc.product_species = photon2 electron2
lc.type = linear_compton
lc.event_multiplier = 1.
lc.probability_threshold = 0.5
lc.probability_target_value = 0.02

# Full diagnostics
diagnostics.diags_names = diag1
diag1.intervals = 1
diag1.diag_type = Full
diag1.fields_to_plot = rho
diag1.write_species = 1
diag1.format = openpmd

my_constants.out_freq_red = 1
# Reduced diagnostics
warpx.reduced_diags_names = FieldEnergy FieldMomentum FieldMaximum ParticleExtrema_photon1 ParticleExtrema_photon2 ParticleExtrema_electron1 ParticleExtrema_electron2 ParticleEnergy ParticleMomentum RhoMaximum ParticleNumber

FieldEnergy.type = FieldEnergy
FieldEnergy.intervals = out_freq_red

FieldMomentum.type = FieldMomentum
FieldMomentum.intervals = out_freq_red

FieldMaximum.type = FieldMaximum
FieldMaximum.intervals = out_freq_red

ParticleExtrema_photon1.type = ParticleExtrema
ParticleExtrema_photon1.intervals = out_freq_red
ParticleExtrema_photon1.species = photon1

ParticleExtrema_photon2.type = ParticleExtrema
ParticleExtrema_photon2.intervals = out_freq_red
ParticleExtrema_photon2.species = photon2

ParticleExtrema_electron1.type = ParticleExtrema
ParticleExtrema_electron1.intervals = out_freq_red
ParticleExtrema_electron1.species = electron1

ParticleExtrema_electron2.type = ParticleExtrema
ParticleExtrema_electron2.intervals = out_freq_red
ParticleExtrema_electron2.species = electron2

ParticleEnergy.type = ParticleEnergy
ParticleEnergy.intervals = out_freq_red

ParticleMomentum.type = ParticleMomentum
ParticleMomentum.intervals = out_freq_red

RhoMaximum.type = RhoMaximum
RhoMaximum.intervals = out_freq_red

ParticleNumber.type = ParticleNumber
ParticleNumber.intervals = out_freq_red
