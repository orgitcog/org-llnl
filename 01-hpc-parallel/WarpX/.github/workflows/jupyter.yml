name: ðŸ“™ Jupyter

on:
  push:
    branches:
      - "development"
  pull_request:
    types: [opened, synchronize, reopened, ready_for_review]

concurrency:
  group: ${{ github.ref }}-${{ github.head_ref }}-jupyter
  cancel-in-progress: true

jobs:

  check_changes:
    name: Analyze
    uses: ./.github/workflows/check_changes.yml

  jupyter_notebooks:
    name: Notebooks
    runs-on: ubuntu-latest
    needs: check_changes
    if: ${{ github.event.pull_request.draft == false && needs.check_changes.outputs.has_non_docs_changes == 'true' }}
    steps:
    - uses: actions/checkout@v4
    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: "3.x"
    - name: Install Dependencies
      run: |
        python -m pip install --upgrade pip
        pip install nbconvert nbformat jupyter
        pip install "sympy<=1.12.1"  # higher versions yield wrong calculations
    - name: Run Notebooks
      run: |
        cd Tools/Algorithms
        jupyter nbconvert --to notebook --execute psatd.ipynb
        jupyter nbconvert --to notebook --execute psatd_pml.ipynb
