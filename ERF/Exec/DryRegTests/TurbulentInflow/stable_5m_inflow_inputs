# ------------------  INPUTS TO MAIN PROGRAM  -------------------
#max_step = 3000000
stop_time = 2700.0

amrex.fpe_trap_invalid = 0

fabarray.mfiter_tile_size = 1024 1024 1024

## PROBLEM SIZE & GEOMETRY (dx=dy=dz=5m)
geometry.prob_lo =   600    0    0
geometry.prob_hi =  1600 2000   300
amr.n_cell        = 200   400    60

geometry.is_periodic = 1 0 0

ylo.type = "Inflow"
yhi.type = "Outflow"
ylo.dirichlet_file = "stable_inflow.txt"
    
#zlo.type = "NoSlipWall"
zlo.type                    = "surface_layer"
erf.most.z0                 = 0.29 
erf.most.k_arr_in = 0 0
erf.most.surf_temp          = 306.0
erf.most.surf_heating_rate  = -1.0

zhi.type = "SlipWall"
zhi.theta_grad = 0.0016666667

erf.sponge_type = "input_sponge"
erf.input_sponge_file = "stable_sponge.txt"
erf.sponge_strength = 2.5
erf.use_yhi_sponge_damping = true
erf.yhi_sponge_start = 1950

# TIME STEP CONTROL
erf.cfl = 1.0 
erf.substepping_cfl = 0.5

# DIAGNOSTICS & VERBOSITY
erf.sum_interval   = 1        # timesteps between computing mass
erf.v              = 1        # verbosity in ERF.cpp
amr.v              = 1        # verbosity in Amr.cpp

# REFINEMENT / REGRIDDING
amr.max_level       = 0       # maximum level number allowed

# CHECKPOINT FILES
erf.check_file      = chk     # root name of checkpoint file
erf.check_int       = -1    # number of timesteps between checkpoints
#erf.restart    	    = chk02000

# PLOTFILES
erf.plot_file_1     = plt     # prefix of plotfile name
erf.plot_int_1      = 10     # number of timesteps between plotfiles
erf.plot_vars_1     = nut scalar density x_velocity y_velocity z_velocity pressure theta pert_pres pert_dens

# SOLVER CHOICE
erf.use_mono_adv       = true
erf.dycore_horiz_adv_type  = "Upwind_3rd"
erf.dycore_vert_adv_type   = "Upwind_3rd"
erf.dryscal_horiz_adv_type = WENO3
erf.dryscal_vert_adv_type  = WENO3
erf.use_gravity = true
erf.use_coriolis = false

# Turbulence closure
erf.molec_diff_type = "None"
erf.les_type = "Deardorff"
erf.Ck       = 0.1  # Coefficient in Moeng1984, Eqn. 19
erf.Ce       = 0.7  # Note: Ce_lcoeff = C_e - 1.9*C_k
erf.Ce_wall  = 3.9  # To account for "wall effects"
erf.sigma_k  = 0.5  # TKE diffusion coeff = 2*Km = Km * inv_sigma_k, Moeng1984, Eqn. 15
erf.theta_ref = 300.0 # don't specify for variable theta when diagnosing stability

erf.rayleigh_damp_U = true
erf.rayleigh_damp_V = true
erf.rayleigh_damp_W = true
erf.rayleigh_damp_T = true
erf.rayleigh_zdamp =  50.0
erf.rayleigh_dampcoef = 0.2

erf.init_type = "input_sounding"
erf.sounding_type = Ideal
erf.input_sounding_file = "stable_sounding.txt"

## Turbulent inflow generation
erf.perturbation_type = "CPM"
erf.perturbation_direction = 0 1 0 0 0 0
erf.perturbation_layers = 3
erf.perturbation_offset = 5
erf.perturbation_box_dims = 8 8 3
erf.perturbation_Ug = 13.5

