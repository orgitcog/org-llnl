#!/bin/bash

trap kill_progs EXIT
kill_progs() {
  for (( ind=0 ;  ind < size_of_collective ; ind++ ))
  do
      var="erase${ind}"
      kill -9 ${!var} > /dev/null 2> /dev/null
      rm -f "sock${ind}"
  done
}

size_of_collective=3
for (( agent_ind = 0; agent_ind < $size_of_collective ; agent_ind++ ))
do
    echo "@unix_hello_exe@" $agent_ind
    "@unix_hello_exe@" $agent_ind & #|& tee output/unix_hello_world_${agent_ind}.log &
    declare "erase${agent_ind}=$!"
done

sleep 12
kill_progs
